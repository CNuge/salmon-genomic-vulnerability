setwd("C:/Users/camnu/bin/salmon-genomic-vulnerability/scripts/tas_inspect_for_ian/")

# library("tidyverse")
source("encode_snps_for_ml.r")

#cd /mnt/c/Users/camnu/bin/salmon-genomic-vulnerability/data/raw/tasmanian_for_ian
tas_ped = "TAS_Salmon_AllFinal.ped"
tas_map = "TAS_Salmon_AllFinal.map"

setwd("C:/Users/camnu/bin/salmon-genomic-vulnerability/data/raw/tasmanian_for_ian/")

tas_data = readPedMap_tsv_fmt(tas_ped, tas_map)

dpath = "C:/Users/camnu/bin/salmon-euro-introgression/data/May2022_SNPchip_220K/SNPchip_100MS_SNPpanel_King7_Compare/SNPchip_220K/"
ped_file_513 = paste0(dpath,"panel_snp_513_set.ped")
map_file_513 = paste0(dpath, "panel_snp_513_set.map")

salmon_513_data = readPedMap_tsv_fmt(ped_file_513, map_file_513)

sum(names(salmon_513_data) %in% names(tas_data))
length(names(salmon_513_data) %in% names(tas_data))

print("only 188 of the markers from the panel present, need to go for conventional pairing and admixture")



#plink --bfile all_fish_Salmo220K_Polyhigh_maf01 --chr-set 30 no-xy --recode --tab --out all_fish_Salmo220K_Polyhigh_maf01
#all_fish_Salmo220K_Polyhigh_maf01
full_dpath = "C:/Users/camnu/bin/salmon-euro-introgression/data/May2022_SNPchip_220K/SNPchip_100MS_SNPpanel_King7_Compare/SNPchip_220K/"
ped_file = paste0(full_dpath,"all_fish_Salmo220K_Polyhigh_maf01.ped")
map_file = paste0(full_dpath, "all_fish_Salmo220K_Polyhigh_maf01.map")

salmon_full_data = readPedMap_tsv_fmt(ped_file, map_file)


overlap = names(tas_data) %in% names(salmon_full_data)

names(salmon_full_data) 

salmon_full_data = salmon_full_data[overlap]