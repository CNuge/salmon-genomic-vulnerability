setwd("C:/Users/camnu/bin/salmon-genomic-vulnerability/data/raw/tasmanian_for_ian/")

library("tidyverse")
library(data.table)
library(FactoMineR)
library(factoextra)
##install.packages('pcadapt')
library(pcadapt)
library(ggman)

taz_salmon = read.pcadapt("TAS_Salmon_AllFinal.bed", type = "bed")
taz_salmon_PCA = pcadapt(taz_salmon, K = 2, min.maf = 0.01)
(taz_salmon_PCA$singular.values)^2*100 # 2.186341 1.772268



taz_salmon_PCA_Scores = data.frame(taz_salmon_PCA$scores)
colnames(taz_salmon_PCA_Scores) = c("PC1", "PC2")


pca_of_taz = ggplot() + 
  geom_point(data = taz_salmon_PCA_Scores, aes(x =PC1, y = PC2))  +
  labs(title = "PCA of data",
       subtitle = "")+
  xlab("PC1 (2.18% of variance explained)") +
  ylab("PC2 (1.77% of variance explained)") +
  theme_classic()

ggsave('PCA_unlabelled_data.png', pca_of_taz)
