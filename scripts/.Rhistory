chr_num = c(1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4, 5, 6, 7, 7, 8, 9, 9, 9, 10, 11, 11, 13, 13, 13, 14, 14, 14, 14, 15, 17, 18, 19, 19, 21, 21, 22, 23, 23, 23, 25, 26, 26, 26, 27, 28, 28, 28)
table(chr_num)
length(chr_num)
length(table(chr_num))
#######
# location
#######
setwd("C:/Users/camnu/bin/salmon-genomic-vulnerability/scripts")
library("tidyverse")
#######
# location
#######
setwd("C:/Users/camnu/bin/salmon-genomic-vulnerability/scripts")
pop_data = read_table("../data/interim/treemix_river_file_10k_sub.txt")
pop_data
het_dat = read_tsv("../data/interim/per_location_heterozygosity_summary.tsv")
het_dat
#drop low sample size locations
high_individ_locations = het_dat$het_dat[het_dat$n_individuals >= 10,]
het_dat
#drop low sample size locations
high_individ_locations = het_dat$location[het_dat$n_individuals >= 10,]
#drop low sample size locations
high_individ_locations = het_dat$location[het_dat$n_individuals >= 10]
high_individ_locations
pop_data
pop_data[high_individ_locations]
high_n_pop_dat = pop_data[high_individ_locations]
high_n_pop_dat
high_n_pop_dat$MNB
have_variance = function(dat) {
out = lapply(dat, function(x) length(unique(x)))
want = which(!out > 1)
unlist(want)
}
have_variance(high_n_pop_dat)
have_variance = function(dat) {
out = lapply(dat, function(x) length(unique(x)))
want = which(!out > 1)
unlist(names(want))
}
have_variance(high_n_pop_dat)
not_mono = have_variance(high_n_pop_dat)
hetero_high_n_pop_dat = high_n_pop_dat(not_mono)
hetero_high_n_pop_dat = high_n_pop_dat[not_mono]
hetero_high_n_pop_dat
out = lapply(dat, function(x) length(unique(x)))
out
high_n_pop_dat
dat = high_n_pop_dat
out = lapply(dat, function(x) length(unique(x)))
out
want = which(!out > 1)
want = which(out > 1)
have_variance = function(dat) {
out = lapply(dat, function(x) length(unique(x)))
want = which(out > 1)
unlist(names(want))
}
not_mono = have_variance(high_n_pop_dat)
hetero_high_n_pop_dat = high_n_pop_dat[not_mono]
hetero_high_n_pop_dat
write_tsv(hetero_high_n_pop_dat, "../data/interim/treemix_river_file_10k_sub_filtered.txt")
?read_table
pop_data = read_table("../data/interim/treemix_river_file_10k_sub.txt")
View(pop_data)
View(pop_data)
?read.csv
pop_data = read.csv("../data/interim/treemix_river_file_10k_sub.txt", sep = " ")
head(pop_data)
pop_data = as_tibble(pop_data)
het_dat = read_tsv("../data/interim/per_location_heterozygosity_summary.tsv")
#drop low sample size locations
high_individ_locations = het_dat$location[het_dat$n_individuals >= 10]
high_n_pop_dat = pop_data[high_individ_locations]
high_n_pop_dat$MNB
have_variance = function(dat) {
out = lapply(dat, function(x) length(unique(x)))
want = which(out > 1)
unlist(names(want))
}
not_mono = have_variance(high_n_pop_dat)
hetero_high_n_pop_dat = high_n_pop_dat[not_mono]
View(hetero_high_n_pop_dat)
View(hetero_high_n_pop_dat)
?write_csv
write_delim(hetero_high_n_pop_dat, "../data/interim/treemix_river_file_10k_sub_filtered.txt", delim = " ")
