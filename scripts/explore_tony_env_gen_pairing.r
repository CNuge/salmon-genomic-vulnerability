setwd("C:/Users/camnu/bin/salmon-genomic-vulnerability/data/")

library('tidyverse')


readPedMap_tsv_fmt = function(ped_file, map_file = "", headers = FALSE){
  if(headers == TRUE){
    #
    map_data = read_tsv(map_file, skip = 1, col_names = c("chromosome", "snp" , "genetic_distance", "physical_distance"))
    
    header_data = c('#family', 'individual', 'sire', 'dam', 'sex', 'pheno')
    header_data = c(header_data, map_data$snp)
    
    snp_data = read_tsv(ped_file, skip = 1, col_names = header_data)
    return(snp_data)
    
  }else{
    
    map_data = read_tsv(map_file, col_names = c("chromosome", "snp" , "genetic_distance", "physical_distance"))
    
    header_data = c('#family', 'individual', 'sire', 'dam', 'sex', 'pheno')
    header_data = c(header_data, map_data$snp)
    
    snp_data = read_tsv(ped_file, col_names = header_data)
    return(snp_data)
  }
  
}



meta_data = read_tsv('./raw/Salmo_220K_Merged2022_ENVmatchyear_Metadata.txt')      


# make ped and map file in case there are needed
#plink --bfile Salmo_220K_Merged2022_COMPLETE_ENVmatchyear --recode --tab --out Salmo_220K_Merged2022_COMPLETE_ENVmatchyear --chr-set 30 no-xy


# read in the raw file and have a look at what is in that
# appears to be dosage encoded genotypes with the main PED leading columns
meta_data = read_tsv('./raw/Salmo_220K_Merged2022_ENVmatchyear_Metadata.txt')      




