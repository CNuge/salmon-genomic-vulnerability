
####
# set the working directory
####

data_path = "C:/Users/camnu/bin/salmon-genomic-vulnerability/data/"
setwd(data_path)


####
# load necessary libraries
####

library(tidyverse)
library(data.table)
library(pcadapt)


####
# Read in the metadata and full PCA file
####
NA_PC_Meta = read_tsv("full_wild_PCA_and_meta.tsv")


####
# look at the plot to find the sub-groups
####

location_pca_of_filtered_NA_wild = ggplot() + 
  geom_point(data = NA_PC_Meta, aes(x =PC1, y = PC2, colour = location_id))  +
  labs(title = "PCA of filtered genetic variation - North American wild individuals",
       subtitle = "coloured by river (149 unique),  5455 individuals, 65576 SNPs")+
  xlab("PC1 (3.39% of variance)") +
  ylab("PC2 (1.46% variance explained)")+
  theme(legend.position = "none")


Prov_pca_of_filtered_NA_wild = ggplot() + 
  geom_point(data = NA_PC_Meta, aes(x =PC1, y = PC2, colour = Province))  +
  labs(title = "PCA of filtered genetic variation - North American wild individuals",
       subtitle = "coloured by Province/State,  5455 individuals, 65576 SNPs")+
  xlab("PC1 (3.39% of variance)") +
  ylab("PC2 (1.46% variance explained)")



## what is in the top cluster of NL?
## Are these from a specific geographic region?

## Top cluster is 433 individuals, 22 from NL rest labrador

# the other 3535 NL individuals all go to the southern cluster.

# again the PCA essentially draws the map!









