library("tidyverse")

#######
# location
####### 
setwd("C:/Users/camnu/bin/salmon-genomic-vulnerability/scripts")


pop_data = read.csv("../data/interim/treemix_river_file_10k_sub.txt", sep = " ")
pop_data = as_tibble(pop_data)

het_dat = read_tsv("../data/interim/per_location_heterozygosity_summary.tsv")


#drop low sample size locations
high_individ_locations = het_dat$location[het_dat$n_individuals >= 10]


high_n_pop_dat = pop_data[high_individ_locations]

high_n_pop_dat$MNB


have_variance = function(dat) {
  out = lapply(dat, function(x) length(unique(x)))
  want = which(out > 1)
  unlist(names(want))
}


not_mono = have_variance(high_n_pop_dat)

hetero_high_n_pop_dat = high_n_pop_dat[not_mono]


write_delim(hetero_high_n_pop_dat, "../data/interim/treemix_river_file_10k_sub_filtered.txt", delim = " ")
