
#####################
# seems like I need to run an admixture proportion analysis for the Eu - NA lineage data
# as I figure these are the steps I need to figure out


#[x] 1. PED -> VCF
# do it for all fish from the admixture analysis, use plink to accomplish this

# cd data/raw/
# 
# plink --bfile wildNA_220k_filtered --chr-set 30 no-xy --recode vcf --out wildNA_220k_filtered
# 
# plink --bfile /mnt/c/Users/camnu/bin/salmon-euro-introgression/data/May2022_SNPchip_220K/SNPchip_100MS_SNPpanel_King7_Compare/SNPchip_220K/wild_Salmo220K_NA_EU_LE_filtered --chr-set 30 no-xy --recode vcf --out wildNA_AND_Eu_220k_filtered



#[] 2. Beagle 4.1 to phase the data
#https://faculty.washington.edu/browning/beagle/b4_1.html
# 
# As per Tony:
# 
# cat Ssal31chroms.tsv | parallel --jobs 4 'java -Xmx400G \
#  -jar /datadisk0/software/beagle.27Jan18.7e1.jar \
#  ref=imputegenos/phasedSalmo.salar.imputeref.allrefimpute.{}.vcf.gz \
#  gl=seaagelc/Salmo.salar.seaage.seaage.impute.{}.vcf.gz \
#  out=imputeseaagegp/{}
# 
#Change locations, inputs, and you'll want to switch to gl to gt
# this should exist, as it was done in Bradbury et al. 2022, had 4993 NA samples in that
# now there are 5441 samples, so about 500 more.
# ^apparently code doesn't get saved... seems repeatable


#[] 3. Run admixture proportion analysis to quantify the presence, position, and size 
#  of European ancestry tracts across the genomes of individuals
# use flare: https://github.com/browning-lab/flare
# seems well documented and same people who made beagle so should interface alright if I get the previous step going.


# isolate this to just the LAB and NFL fish, as well as Eu if needed(?)

#a. 
#b. Eu Fish and the LAB
#c. Eu Fish and the NFL
#d. Eu Fish and the MAR
#e. all NA baseline 


