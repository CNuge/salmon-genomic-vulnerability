
# GONe off of only a .map .ped and a param file, 
# so should not be too taxing to set up. 

#https://github.com/esrud/GONE/blob/master/GONE%20TUTORIAL.pdf

# from paper: Recent Demographic History Inferred by High-Resolution Analysis of Linkage Disequilibrium
#               https://doi.org/10.1093/molbev/msaa169


# Use the "new" versions relative to the v3 genome for both
# looks like family labels persist, so I'm going to try with just the cluster
# files and see if I can use these to get the location level ne estimats, 
# if not going to have to double back and convert all the populations separately

data/raw/LD_files/new_wildNA_220k_filtered.ped
data/raw/LD_files/new_wildNA_220k_filtered.map


# installed on VM
cd /genomics/CNuge/GONE/Linux

#running first try, before uploading other files
bash script_GONE.sh new_Labrador_220k_filtered

#note, may need to exclude the admixture regions, only high homeQ
#otherwise will get confounds/artefacts in Ne
bash script_GONE.sh new_Labrador_220k_filtered

#bash script_GONE.sh new_Newfoundland_220k_filtered
#shuf -n 1700 new_Newfoundland_220k_filtered.ped > ds_new_Newfoundland_220k_filtered.ped
#cp new_Newfoundland_220k_filtered.map ds_new_Newfoundland_220k_filtered.map
bash script_GONE.sh ds_new_Newfoundland_220k_filtered

bash script_GONE.sh new_STLawrence_220k_filtered


#Also try with:
/data/raw/high_Q_Labrador_220k_filtered
/data/raw/high_Q_Newfoundland_220k_filtered #failed?
/data/raw/high_Q_STLawrence_220k_filtered

#need to rm the TEMP ils
bash script_GONE.sh high_Q_Labrador_220k_filtered
#bash script_GONE.sh high_Q_Newfoundland_220k_filtered #failed? dropped to 1700 samples at random as 1800 limit for GONE
bash script_GONE.sh ds_high_Q_Newfoundland_220k_filtered #failed? dropped to 1700 samples at random as 1800 limit for GONE
bash script_GONE.sh high_Q_STLawrence_220k_filtered

#download both and compare, see if admixture confound present

cd /data/interim/
mkdir GONE_outputs
#the sftp them into there
