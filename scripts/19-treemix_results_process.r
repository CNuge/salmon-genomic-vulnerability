#######
# location
####### 
setwd("C:/Users/camnu/bin/salmon-genomic-vulnerability/data/interim/")

#######
# libraries
####### 

library(tidyverse)

#######
# functions
#######
source("../../scripts/treemix_plotting_funcs.r")

#######
# data
#######

#metadata for the populations
clustered_full_data_PCA = read_tsv("cluster_and_q_data_combined.tsv")



#three cluster
#prefix : treemix_threepop_out
plot_tree("treemix_threepop_out", mbar = F)


#three cluster, with migrants
#prefix : treemix_threepop_migration2_out
plot_tree("treemix_threepop_migration2_out")

#by river 
#prefix : treemix_per_river_out

#ordered by majority cluster and then latitude
plot_tree("treemix_per_river_out", o = "treemix_river_order" , mbar = F)

plot_resid("treemix_per_river_out", "treemix_river_order")

#count order
#20 LAB
#66 NFL
#61 STL


# TODO have a look at tony's code and see if I can use this to switch up the order
#https://github.com/TonyKess/Gander_charr/blob/main/prep_treemix.R